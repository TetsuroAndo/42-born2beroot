# セットアップコマンドの説明

## 1. 基本設定

- `usermod -aG sudo $USER`
  - 現在のユーザーを sudo グループに入れる

## 2. SSH の設定

- SSH サービスの有効化と起動
- ポート番号を 22 から 4242 に変更
- root ログインの禁止
- パスワード認証の有効化

## 3. ファイアウォール（UFW）の設定

- ポート 4242 の制限付き許可
- UFW の有効化

## 4. パスワードポリシーの設定

### 基本ルール

- パスワードの最小長：10 文字
- 大文字を最低 1 文字含む
- 小文字を最低 1 文字含む
- 数字を最低 1 文字含む
- 同じ文字の連続使用は 3 回まで
- ユーザー名を含めることを禁止
- 古いパスワードとは 7 文字以上異なる必要がある
- root ユーザーにも同じルールを適用

### パスワード有効期限

- 最大有効期間：30 日
- 最小変更間隔：2 日

## 5. グループとユーザーの管理

- user42 グループの作成
- ユーザーを user42 グループに追加

## 6. sudo 設定

- sudo ログの設定
  - ログファイル：/var/log/sudo/sudo.log
  - 入力と出力のログを記録
- sudo 実行時のルール
  - パスワード試行回数：3 回
  - TTY の要求
  - セキュアパスの設定

## 7. モニタリングスクリプトの設定

- 実行権限の設定（750）
- 所有者とグループの設定
- cron による定期実行の設定
- パスワードなしでの実行権限付与

# Linux システムの重要なパスの説明

## システム設定ファイル

### /etc/ssh/sshd_config

- SSH デーモンの設定ファイル
- 接続ポート、認証方式、root ログインの可否などの SSH サーバーの動作を制御

### /etc/pam.d/common-password

- PAM（Pluggable Authentication Modules）のパスワードポリシー設定ファイル
- システム全体のパスワード要件（長さ、複雑さなど）を定義

### /etc/login.defs

- ユーザーアカウントとパスワードの基本設定ファイル
- パスワードの有効期限、ユーザー ID の範囲などを管理

### /etc/sudoers

- sudo コマンドの設定ファイル
- ユーザーの権限、実行ルール、ログ設定などを定義
- 直接編集せず、`visudo`コマンドを使用することを推奨

## ログファイル

### /var/log/sudo/sudo.log

- sudo コマンドの実行ログを保存
- コマンドの入力と出力、実行時刻、実行ユーザーなどを記録
- セキュリティ監査に重要

## 実行ファイル

### /usr/local/bin/monitoring.sh

- システムモニタリングスクリプトの配置場所
- システム管理者用のスクリプトを配置する標準的なディレクトリ
- PATH に含まれており、システム全体からアクセス可能

## システムパス

### セキュアパス（/usr/local/sbin:/usr/local/bin:/usr/bin:/sbin:/bin）

- sudo コマンド実行時に使用される信頼できるパス
- システムコマンドの安全な実行を確保
- 各ディレクトリの役割：
  - /usr/local/sbin: ローカルシステム管理用バイナリ
  - /usr/local/bin: ローカルユーザー用バイナリ
  - /usr/bin: システム標準のユーザーコマンド
  - /sbin: システム管理用バイナリ
  - /bin: 基本的なシステムコマンド

## グループとユーザー管理

### user42 グループ

- プロジェクト用の特別なユーザーグループ
- グループメンバーに特定の権限を付与するために使用

### sudo グループ

- 管理者権限（sudo）を持つユーザーのグループ
- システム管理タスクの実行が可能
